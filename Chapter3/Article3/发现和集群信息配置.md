## 重要的发现和集群的形成设置

在投入生产之前，应该配置两个重要的发现和集群形成设置，以便集群中的节点可以彼此发现并选举一个主节点。

#### `discovery.seed_hosts`

开箱即用，无需任何网络配置，Elasticsearch将绑定到可用的环回地址，并将扫描本地端口9300至9305，以尝试连接到同一服务器上运行的其他节点。这无需任何配置即可提供自动群集体验。

如果要与其他主机上的节点组成集群，则应使用此`discovery.seed_hosts`设置提供集群中其他主机 的列表，这些主机符合主机要求并且可能处于活动状态且可联系，以便为[发现过程](https://www.elastic.co/guide/en/elasticsearch/reference/7.x/modules-discovery-hosts-providers.html)提供种子。此设置应该是群集中所有符合主机资格的节点的地址的列表。每个地址可以是IP地址，也可以是通过DNS解析为一个或多个IP地址的主机名。

如果符合主机资格的节点没有固定的名称或地址，请使用 [备用主机提供程序](https://www.elastic.co/guide/en/elasticsearch/reference/7.x/modules-discovery-hosts-providers.html#built-in-hosts-providers)动态查找其地址。

#### `cluster.initial_master_nodes`

首次启动全新的Elasticsearch群集时，会出现一个[群集引导](https://www.elastic.co/guide/en/elasticsearch/reference/7.x/modules-discovery-bootstrap-cluster.html)步骤，该步骤确定了在第一次选举中便对其票数进行计数的主资格节点的集合。在[开发模式下](https://www.elastic.co/guide/en/elasticsearch/reference/7.x/bootstrap-checks.html#dev-vs-prod-mode)（未配置发现设置），此步骤由节点自己自动执行。由于这种自动引导从[本质上来说](https://www.elastic.co/guide/en/elasticsearch/reference/7.x/modules-discovery-quorums.html)是[不安全的](https://www.elastic.co/guide/en/elasticsearch/reference/7.x/modules-discovery-quorums.html)，因此在[生产模式下](https://www.elastic.co/guide/en/elasticsearch/reference/7.x/bootstrap-checks.html#dev-vs-prod-mode)启动全新群集时，必须明确列出符合资格的主机节点，并在第一次选举中对其选票进行计数。使用设置来`cluster.initial_master_nodes`设置此列表 。重新启动集群或将新节点添加到现有集群时，不应使用此设置。

```yaml
discovery.seed_hosts:
   - 192.168.1.10:9300
   - 192.168.1.11 
   - seeds.mydomain.com 
   - [0:0:0:0:0:ffff:c0a8:10c]:9301 
cluster.initial_master_nodes: 
   - master-node-a
   - master-node-b
   - master-node-c
```

1. 端口是可选的，通常默认为`9300`，但是某些设置可以[覆盖](https://www.elastic.co/guide/en/elasticsearch/reference/7.x/modules-discovery-hosts-providers.html#built-in-hosts-providers)此默认值。
2. 如果主机名解析为多个IP地址，则该节点将尝试在所有解析的地址处发现其他节点。
3. IPv6地址必须放在方括号中。
4. 初始主节点应通过其标识 [`node.name`](https://www.elastic.co/guide/en/elasticsearch/reference/7.x/node.name.html)，默认为其主机名。确保中的值完全`cluster.initial_master_nodes`匹配`node.name`。如果您使用完全限定的域名（例如，将其 `master-node-a.example.com`用作节点名称），则必须在此列表中使用完全限定的名称。相反，如果`node.name`是裸机主机名而没有任何尾随限定符，则还必须省略中的尾随限定符`cluster.initial_master_nodes`。

有关更多信息，请参阅[引导集群](https://www.elastic.co/guide/en/elasticsearch/reference/7.x/modules-discovery-bootstrap-cluster.html)以及 [发现和集群形成设置](https://www.elastic.co/guide/en/elasticsearch/reference/7.x/modules-discovery-settings.html)。